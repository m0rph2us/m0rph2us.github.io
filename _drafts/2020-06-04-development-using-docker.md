---
layout: post
excerpt_separator: <!--more-->
title: Development Using Docker
categories: mysql cdc debezium
---

# 도커(Docker)를 활용한 개발
## 개요

요즘의 개발, 인프라 구성은 컨테이너 기술을 활용하는 것이 대세가 되어가는 추세다. 이 글에서는 컨테이너의 개념을 간략히 설명하고, 개발 및 인프라 구성을 할 때 어떻게 활용할 수 있는지를 설명하려고 한다.
<!--more-->

## 컨테이너 vs VM

먼저 컨테이너와 VM의 차이를 짚고 넘어갈 필요가 있다. 이 두 가지가 동작하는 방식은 서로 완전히 다르다.

{:refdef: style="text-align: center;"}
![architecture](/assets/containers-101-2x.png)
{:refdef}

위 그림에서는 왼쪽이 VM, 오른쪽이 컨테이너를 보여주고 있다.

VM은 Virtual Machine, 즉, 가상의 컴퓨터다. 이렇게 가상의 컴퓨터를 구동해 주는 것을 하이퍼바이저(hypervisor)라고 하며, 이러한 하이퍼바이저에는 여러분도 익숙한 VMWare, Oracle VirtualBox, QEMU, KVM 등이 있다. 가상의 컴퓨터이기 때문에 OS를 직접 만들어 올릴 수도 있고, 윈도우, 리눅스, DOS 등 가리지 않고 실제 컴퓨터로 할 수 있는 거의 모든 것을 할 수 있다. 호스트 OS가 무엇이든 상관없이 하이퍼바이저가 지원만 하면 되기 때문에 활용성이 굉장히 높다. 하지만, OS 위에 또 다른 OS가 올라가는 형태이기 때문에 호스트 OS의 리소스를 많이 사용할 수 밖에 없고, 실제 하드웨어 액세스는 게스트 OS <-> 하이퍼바이저 <-> 호스트 OS의 형태로 이루어지기 때문에 매우 느리다.

컨테이너를 보여주는 오른쪽 그림을 유심히 보면 게스트OS와 하이퍼바이저 자리에 컨테이너 런타임이 위치한다. 이러한 컨테이너 런타임은 호스트 OS 커널에서 컨테이너를 직접 구동하기 때문에 VM에 비해 훨씬 빠르고, 메모리를 적게 차지한다. 널리 사용되는 컨테이너 런타임에는 도커, rkt 등이 있다. VM만큼의 리소스 격리성은 아니지만, 여전히 높은 수준의 리소스 격리성을 제공한다. 도커는 LXC(Linux Container)기반이기 때문에 호스트 OS가 리눅스 커널이어야만 한다. 맥이나 윈도우는 작은 Linux VM이 설치되고 그 위에서 컨테이너를 구동한다.

컨테이너가 제공하는 높은 수준의 격리성, 빠른 애플리케이션 패키징 및 구동 속도는 최근의 소프트웨어 개발 및 배포 라이프사이클에 큰 영향을 주고 있다.

## 도커

도커는 가장 대중화된 컨테이너 런타임이다. 이것 저것 알아야 할 용어들이 많지만, 핵심적인 것을 나열해 보면 다음과 같다.

* 도커 이미지
  * 도커 컨테이너 런타임으로 구동할 수 있는 이미지이다. 이러한 이미지는 바닥부터 직접 만들 수도 있고, 누군가 이미 만들어둔 이미지를 이용하여 확장할 수도 있다.
* 레지스트리
  * 도커 이미지 저장소 정도로 생각하면 된다. 퍼블릭 레지스트리로는 도커허브([Docker Hub](https://hub.docker.com/))가 있다.
* 도커 커맨드
  * 도커 이미지를 레지스트리에서 가져오거나 푸시하고, 구동 및 관리하는 커맨드이다.
* 도커 컴포즈
  * 도커 커맨드는 옵션이 굉장히 많다. 일일이 커맨드로 입력하여 사용하기 어려울 수 있기 때문에 관리 편의를 위해 yaml로 정의하여 사용하는 것이 좋다. 스웜이라는 컨테이너 오케스트레이션 도구가 존재하지만 두 포맷의 호환이 매끄럽게 되지 않는 문제가 있어 둘 중 하나를 선택해야 하는 문제가 생긴다. 본인은 도커 컴포즈를 더 선호한다.

이정도면 됐고, 기본 사용법을 알아보도록 하자.

## 기본 사용법

도커가 설치되어 있지 않다면 먼저 설치해야 한다. 설치 방법은 [여기](https://docs.docker.com/engine/install/)를 참고하기 바란다. 설치가 되었다면 다음과 같이 도커 이미지를 당겨(pull) 올 수 있다.

docker run docker/whalesay cowsay boo

## 도커를 이용한 개발

## GitOps

## 리소스 조정

## 참고

1. [컨테이너 vs VM](https://cloud.google.com/containers?hl=ko)
